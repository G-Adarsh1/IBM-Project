<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intelligent Study Planner</title>
<style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;}
    .container{max-width:1400px;margin:0 auto;background:white;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden;}
    header{background:linear-gradient(135deg,#2563eb 0%,#1e40af 100%);color:white;padding:30px;text-align:center;}
    header h1{font-size:2.5em;margin-bottom:10px;}
    header p{opacity:0.9;font-size:1.1em;}
    .main-content{display:grid;grid-template-columns:400px 1fr;gap:0;min-height:600px;}
    .sidebar{background:#f8fafc;border-right:2px solid #e2e8f0;padding:30px;overflow-y:auto;max-height:calc(100vh - 200px);}
    .content-area{padding:30px;overflow-y:auto;max-height:calc(100vh - 200px);}
    .section{margin-bottom:30px;}
    .section h2{color:#1e40af;margin-bottom:15px;font-size:1.4em;display:flex;align-items:center;gap:10px;}
    .card{background:white;border-radius:12px;padding:20px;margin-bottom:15px;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:transform 0.2s, box-shadow 0.2s;}
    .card:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.15);}
    .form-group{margin-bottom:15px;}
    label{display:block;color:#334155;font-weight:600;margin-bottom:5px;font-size:0.9em;}
    input,select,textarea{width:100%;padding:10px;border:2px solid #e2e8f0;border-radius:8px;font-size:1em;transition:border-color 0.3s;}
    input:focus,select:focus,textarea:focus{outline:none;border-color:#2563eb;}
    textarea{resize:vertical;min-height:60px;}
    button{background:linear-gradient(135deg,#2563eb 0%,#1e40af 100%);color:white;border:none;padding:12px 24px;border-radius:8px;font-size:1em;font-weight:600;cursor:pointer;transition:transform 0.2s,box-shadow 0.2s;width:100%;}
    button:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(37,99,235,0.4);}
    button:active{transform:translateY(0);}
    .btn-secondary{background:linear-gradient(135deg,#64748b 0%,#475569 100%);}
    .btn-danger{background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%);}
    .btn-small{padding:6px 12px;font-size:0.85em;width:auto;display:inline-block;margin-right:5px;}
    .task-card{border-left:4px solid #2563eb;position:relative;}
    .task-card.priority-high{border-left-color:#ef4444;}
    .task-card.priority-medium{border-left-color:#f59e0b;}
    .task-card.priority-low{border-left-color:#10b981;}
    .task-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:10px;}
    .task-title{font-size:1.1em;font-weight:600;color:#1e293b;}
    .task-meta{font-size:0.85em;color:#64748b;margin-bottom:8px;}
    .priority-badge{display:inline-block;padding:3px 10px;border-radius:12px;font-size:0.75em;font-weight:600;text-transform:uppercase;}
    .priority-high{background:#fee2e2;color:#dc2626;}
    .priority-medium{background:#fef3c7;color:#d97706;}
    .priority-low{background:#d1fae5;color:#059669;}
    .progress-bar{width:100%;height:8px;background:#e2e8f0;border-radius:4px;overflow:hidden;margin:10px 0;}
    .progress-fill{height:100%;background:linear-gradient(90deg,#2563eb 0%,#1e40af 100%);transition:width 0.3s;}
    .task-actions{display:flex;gap:5px;margin-top:10px;flex-wrap:wrap;}
    .schedule-view{background:white;}
    .view-tabs{display:flex;gap:10px;margin-bottom:20px;border-bottom:2px solid #e2e8f0;}
    .tab{padding:10px 20px;background:none;border:none;color:#64748b;font-weight:600;cursor:pointer;border-bottom:3px solid transparent;transition:all 0.3s;width:auto;}
    .tab.active{color:#2563eb;border-bottom-color:#2563eb;}
    .schedule-grid{display:grid;gap:20px;}
    .day-card{background:#f8fafc;border-radius:12px;padding:20px;border:2px solid #e2e8f0;}
    .day-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:10px;border-bottom:2px solid #e2e8f0;}
    .day-name{font-size:1.2em;font-weight:700;color:#1e40af;}
    .day-hours{font-size:0.9em;color:#64748b;}
    .time-block{background:white;border-radius:8px;padding:12px;margin-bottom:10px;border-left:4px solid #2563eb;box-shadow:0 1px 3px rgba(0,0,0,0.1);}
    .time-block-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;}
    .time-block-title{font-weight:600;color:#1e293b;}
    .time-block-duration{font-size:0.85em;color:#64748b;}
    .empty-schedule{text-align:center;padding:40px;color:#94a3b8;}
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:20px;}
    .stat-card{background:linear-gradient(135deg,#2563eb 0%,#1e40af 100%);color:white;padding:20px;border-radius:12px;text-align:center;}
    .stat-value{font-size:2em;font-weight:700;margin-bottom:5px;}
    .stat-label{font-size:0.9em;opacity:0.9;}
    .availability-grid{display:grid;gap:10px;}
    .availability-row{display:grid;grid-template-columns:100px 1fr;gap:10px;align-items:center;}
    .day-label{font-weight:600;color:#334155;}
    @media(max-width:1024px){.main-content{grid-template-columns:1fr;}.sidebar{border-right:none;border-bottom:2px solid #e2e8f0;max-height:none;}}
    .weekly-view{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px;}
</style>
</head>
<body>
<div class="container">
    <header>
        <h1>Study Planner</h1>
        <p>Smart scheduling for academic success</p>
    </header>

    <div class="main-content">
        <div class="sidebar">
            <div class="section">
                <h2>‚ûï Add New Task</h2>
                <div class="card">
                    <form id="taskForm">
                        <div class="form-group">
                            <label>Task Title</label>
                            <input type="text" id="taskTitle" required placeholder="e.g., Study Chapter 5">
                        </div>
                        <div class="form-group">
                            <label>Deadline</label>
                            <input type="date" id="taskDeadline" required>
                        </div>
                        <div class="form-group">
                            <label>Estimated Hours</label>
                            <input type="number" id="taskHours" min="0.5" step="0.5" required placeholder="e.g., 3">
                        </div>
                        <div class="form-group">
                            <label>Description (Optional)</label>
                            <textarea id="taskDescription" placeholder="Add notes or details about this task..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select id="taskPriority">
                                <option value="high">High</option>
                                <option value="medium" selected>Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                        <button type="submit">Add Task</button>
                    </form>
                </div>
            </div>

            <div class="section">
                <h2>‚è∞ Daily Availability</h2>
                <div class="card">
                    <div class="availability-grid" id="availabilityGrid"></div>
                    <button id="updateAvailabilityBtn" style="margin-top:15px;">Update Schedule</button>
                </div>
            </div>
        </div>

        <div class="content-area">
            <div class="stats-grid" id="statsGrid"></div>

            <div class="view-tabs">
                <button class="tab active" onclick="switchView('tasks')">All Tasks</button>
                <button class="tab" onclick="switchView('daily')">Daily Schedule</button>
                <button class="tab" onclick="switchView('weekly')">Weekly View</button>
            </div>

            <div id="tasksView" class="schedule-view">
                <div class="section">
                    <h2>üìã Your Tasks</h2>
                    <div id="tasksList"></div>
                </div>
            </div>

            <div id="dailyView" class="schedule-view" style="display:none;">
                <div class="section">
                    <h2>üìÖ Daily Schedule</h2>
                    <div id="dailySchedule" class="schedule-grid"></div>
                </div>
            </div>

            <div id="weeklyView" class="schedule-view" style="display:none;">
                <div class="section">
                    <h2>üìÜ Weekly Overview</h2>
                    <div id="weeklySchedule" class="weekly-view"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>

    // ===== DATA
    let tasks = [];
    let schedule = {};
    let availability = {monday:4,tuesday:4,wednesday:4,thursday:4,friday:4,saturday:6,sunday:6};

    // ===== STORAGE =====
    function saveData(){
        localStorage.setItem('studyPlannerTasks',JSON.stringify(tasks));
        localStorage.setItem('studyPlannerAvailability',JSON.stringify(availability));
        localStorage.setItem('studyPlannerSchedule',JSON.stringify(schedule));
    }

    function loadData(){
        tasks = JSON.parse(localStorage.getItem('studyPlannerTasks') || '[]');
        availability = JSON.parse(localStorage.getItem('studyPlannerAvailability') || '{}');
        if(Object.keys(availability).length===0){
            availability={monday:4,tuesday:4,wednesday:4,thursday:4,friday:4,saturday:6,sunday:6};
        }
    }

    // ===== INIT =====
    function init(){
        loadData();
        setMinDate();
        renderAvailabilityInputs();
        generateSchedule();
        renderAll();

        // Task form
        document.getElementById('taskForm').addEventListener('submit',function(e){
            e.preventDefault();
            const task={
                id:Date.now(),
                title:document.getElementById('taskTitle').value,
                description:document.getElementById('taskDescription').value,
                deadline:document.getElementById('taskDeadline').value,
                estimatedHours:parseFloat(document.getElementById('taskHours').value),
                priority:document.getElementById('taskPriority').value,
                completedHours:0,
                createdAt:new Date().toISOString()
            };
            tasks.push(task);
            saveData();
            generateSchedule();
            renderAll();
            this.reset();
            setMinDate();
        });

        document.getElementById('updateAvailabilityBtn').addEventListener('click',()=>{
            updateAvailability();
        });
    }

    function setMinDate(){
        const today=new Date().toISOString().split('T')[0];
        document.getElementById('taskDeadline').min=today;
    }

    // ===== AVAILABILITY =====
    function renderAvailabilityInputs(){
        const grid=document.getElementById('availabilityGrid');
        grid.innerHTML='';
        Object.keys(availability).forEach(day=>{
            const row=document.createElement('div');
            row.className='availability-row';
            row.innerHTML=`
                <div class="day-label">${day.charAt(0).toUpperCase()+day.slice(1)}</div>
                <input type="number" min="0" step="0.5" value="${availability[day]}" id="avail-${day}">
            `;
            grid.appendChild(row);
        });
    }

    function updateAvailability(){
        Object.keys(availability).forEach(day=>{
            const val=parseFloat(document.getElementById(`avail-${day}`).value);
            if(!isNaN(val)) availability[day]=val;
        });
        saveData();
        generateSchedule();
        renderAll();
        alert('Availability updated!');
    }

    // ===== TASK RENDER =====
    function renderTasks(){
        const list=document.getElementById('tasksList');
        list.innerHTML='';
        if(tasks.length===0){
            list.innerHTML='<div class="empty-schedule">No tasks added yet.</div>';
            return;
        }
        tasks.sort((a,b)=>{
            const prio={'high':1,'medium':2,'low':3};
            return prio[a.priority]-prio[b.priority];
        });
        tasks.forEach(task=>{
            const card=document.createElement('div');
            card.className=`card task-card priority-${task.priority}`;
            card.innerHTML=`
                <div class="task-header">
                    <div class="task-title">${task.title}</div>
                    <div class="task-meta">${task.deadline}</div>
                </div>
                <div class="task-meta">${task.description}</div>
                <div class="progress-bar"><div class="progress-fill" style="width:${(task.completedHours/task.estimatedHours*100).toFixed(0)}%"></div></div>
                <div class="task-actions">
                    <button class="btn-small btn-secondary" onclick="updateProgress(${task.id},0.5)">+0.5h</button>
                    <button class="btn-small btn-secondary" onclick="updateProgress(${task.id},1)">+1h</button>
                    <button class="btn-small" onclick="completeTask(${task.id})">‚úÖ Complete</button>
                    <button class="btn-small btn-danger" onclick="deleteTask(${task.id})">üóë Delete</button>
                </div>
            `;
            list.appendChild(card);
        });
    }

    function updateProgress(id,hrs){
        const task=tasks.find(t=>t.id===id);
        if(task){
            task.completedHours=Math.min(task.completedHours+hrs,task.estimatedHours);
            saveData();
            renderAll();
        }
    }

    function completeTask(id){
        const task=tasks.find(t=>t.id===id);
        if(task){
            task.completedHours=task.estimatedHours;
            saveData();
            renderAll();
        }
    }

    function deleteTask(id){
        tasks=tasks.filter(t=>t.id!==id);
        saveData();
        generateSchedule();
        renderAll();
    }

    // ===== STATS =====
    function renderStats(){
        const grid=document.getElementById('statsGrid');
        const totalTasks=tasks.length;
        const completedTasks=tasks.filter(t=>t.completedHours>=t.estimatedHours).length;
        const pendingTasks=totalTasks-completedTasks;
        const totalHours=tasks.reduce((acc,t)=>acc+t.estimatedHours,0);
        const completedHours=tasks.reduce((acc,t)=>acc+t.completedHours,0);

        grid.innerHTML=`
            <div class="stat-card"><div class="stat-value">${totalTasks}</div><div class="stat-label">Total Tasks</div></div>
            <div class="stat-card"><div class="stat-value">${completedTasks}</div><div class="stat-label">Completed Tasks</div></div>
            <div class="stat-card"><div class="stat-value">${pendingTasks}</div><div class="stat-label">Pending Tasks</div></div>
            <div class="stat-card"><div class="stat-value">${totalHours.toFixed(1)}</div><div class="stat-label">Total Hours</div></div>
            <div class="stat-card"><div class="stat-value">${completedHours.toFixed(1)}</div><div class="stat-label">Hours Completed</div></div>
        `;
    }

    // ===== SCHEDULING =====
// ===== INTELLIGENT SCHEDULING =====
function generateSchedule(){
    const days=['monday','tuesday','wednesday','thursday','friday','saturday','sunday'];
    schedule={};

    // Reset schedule
    days.forEach(day => schedule[day]=[]);

    // Filter pending tasks and sort by deadline then priority
    const pendingTasks = tasks
        .filter(t => t.completedHours < t.estimatedHours)
        .sort((a,b) => {
            const dateA = new Date(a.deadline), dateB = new Date(b.deadline);
            if(dateA - dateB !== 0) return dateA - dateB; // Earliest deadline first
            const prio={'high':1,'medium':2,'low':3};
            return prio[a.priority]-prio[b.priority];
        });

    // Get today's day index
    const todayIndex = new Date().getDay(); // 0=Sunday, 1=Monday, ..., 6=Saturday
    // Map day index to our 'days' array
    const dayMap = [ 'sunday','monday','tuesday','wednesday','thursday','friday','saturday' ];

    // Distribute tasks
    pendingTasks.forEach(task => {
        let hoursLeft = task.estimatedHours - task.completedHours;

        // Try assigning to each day until deadline
        const taskDeadlineIndex = (new Date(task.deadline)).getDay();
        for(let i=0; i<7; i++){
            const dIndex = (todayIndex + i) % 7;
            const dayName = dayMap[dIndex];

            // Only schedule before deadline
            if(dIndex > taskDeadlineIndex) continue;

            const remainingHours = availability[dayName] - (schedule[dayName].reduce((acc,b)=>acc+b.hours,0));
            if(remainingHours <= 0) continue;

            const assignHours = Math.min(hoursLeft, remainingHours);
            schedule[dayName].push({taskId:task.id, hours:assignHours});
            hoursLeft -= assignHours;

            if(hoursLeft <= 0) break;
        }
    });

    saveData();
}

function renderDailySchedule() {
    const container = document.getElementById('dailySchedule');
    const today = new Date();
    const scheduleEntries = [];

    // Show next 7 days
    for (let i = 0; i < 7; i++) {
        const date = new Date(today);
        date.setDate(date.getDate() + i);
        const dateStr = date.toISOString().split('T')[0];
        const dayName = date.toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();

        const daySchedule = schedule[dayName] || [];
        // Filter out completed tasks
        const tasksForDay = daySchedule
            .map(s => tasks.find(t => t.id === s.taskId))
            .filter(t => t && t.completedHours < t.estimatedHours);

        scheduleEntries.push({
            dayName,
            date: dateStr,
            availableHours: availability[dayName] || 4,
            scheduledHours: tasksForDay.reduce((sum,t)=>sum+t.estimatedHours-t.completedHours,0),
            tasks: tasksForDay.map(t => ({
                taskId: t.id,
                title: t.title,
                hours: t.estimatedHours - t.completedHours,
                priority: t.priority
            }))
        });
    }

    container.innerHTML = scheduleEntries.map(day => {
        const date = new Date(day.date);
        const displayDate = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        const isToday = day.date === today.toISOString().split('T')[0];

        return `
            <div class="day-card" style="${isToday ? 'border-color: #2563eb; border-width: 3px;' : ''}">
                <div class="day-header">
                    <div>
                        <div class="day-name">${day.dayName.charAt(0).toUpperCase() + day.dayName.slice(1)}</div>
                        <div style="font-size: 0.9em; color: #64748b;">${displayDate}</div>
                    </div>
                    <div class="day-hours">
                        ${day.scheduledHours.toFixed(1)}h / ${day.availableHours}h
                    </div>
                </div>
                ${day.tasks.length > 0 ? day.tasks.map(task => `
                    <div class="time-block">
                        <div class="time-block-header">
                            <div class="time-block-title">${task.title}</div>
                            <div class="time-block-duration">${task.hours}h</div>
                        </div>
                        <span class="priority-badge priority-${task.priority}">${task.priority}</span>
                    </div>
                `).join('') : '<div style="text-align: center; padding: 20px; color: #94a3b8;">No tasks scheduled</div>'}
            </div>
        `;
    }).join('');
}


    function renderWeeklyView(){
        const container=document.getElementById('weeklySchedule');
        container.innerHTML='';
        const days=['monday','tuesday','wednesday','thursday','friday','saturday','sunday'];
        days.forEach(day=>{
            const dayBlocks=schedule[day]||[];
            const totalDayHours=dayBlocks.reduce((acc,b)=>acc+b.hours,0);
            const card=document.createElement('div');
            card.className='day-card';
            card.innerHTML=`<div class="day-name">${day.charAt(0).toUpperCase()+day.slice(1)}</div><div class="day-hours">Total: ${totalDayHours.toFixed(1)}h</div>`;
            container.appendChild(card);
        });
    }

    function renderAll(){
        renderStats();
        renderTasks();
        renderDailySchedule();
        renderWeeklyView();
    }

    // ===== VIEW SWITCH =====
    function switchView(view){
        document.querySelectorAll('.schedule-view').forEach(el=>el.style.display='none');
        document.getElementById(`${view}View`).style.display='block';
        document.querySelectorAll('.tab').forEach(btn=>btn.classList.remove('active'));
        event.currentTarget.classList.add('active');
    }

    // ===== GLOBAL FUNCTIONS =====
    window.updateProgress=updateProgress;
    window.completeTask=completeTask;
    window.deleteTask=deleteTask;
    window.updateAvailability=updateAvailability;
    window.switchView=switchView;

    // ===== INIT APP =====
    init();

   

   
</script>
</body>
</html>


